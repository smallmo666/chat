# 可视化升级方案：组合图表推荐 (Combination Chart)

为了满足更复杂的业务分析需求，我们将升级系统的可视化模块，使其支持**组合图表 (Combination Chart)**，特别是**双轴图 (Dual Axis)**。这将允许用户在同一个图表中同时查看量级差异巨大的指标（例如“销售额”与“同比增长率”）。

## 1. 核心变更点

### 1.1 可视化顾问 (Visualization Advisor)
*   **文件**: `src/workflow/nodes/visualization_advisor.py`
*   **变更**: 更新 `VIZ_ADVISOR_PROMPT`。
    *   新增**第 6 条推荐原则**：针对“量级差异巨大”或“总量+比率”的场景，推荐 `combination` 类型。
    *   扩充 `chart_type` 枚举值，增加 `combination`。

### 1.2 可视化生成器 (Visualization Node)
*   **文件**: `src/workflow/nodes/visualization.py`
*   **变更**: 更新生成 ECharts 配置的 Prompt。
    *   增加对 `combination` 类型的处理逻辑：
        *   **双 Y 轴**: 指导 LLM 配置两个 `yAxis`。
        *   **混合图表**: 指导 LLM 将绝对值（如 Sales）映射为 `bar`，将比率（如 Rate）映射为 `line`。
        *   **轴索引**: 正确设置 `yAxisIndex`。

## 2. 预期效果
*   **场景**: 用户查询“按月统计销售额和毛利率”。
*   **Advisor**: 识别出“销售额”（大数值）和“毛利率”（百分比），推荐 `chart_type: "combination"`。
*   **Visualization**: 生成一个 ECharts 配置，左轴为销售额（柱状图），右轴为毛利率（折线图）。

## 3. 实施步骤
1.  修改 `visualization_advisor.py` 中的 Prompt，增加组合图规则。
2.  修改 `visualization.py` 中的 Prompt，增加双轴图表的生成指导。
